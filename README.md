# officer

#### Обработчик офисных документов
Реализация специально придуманной задачи с целью ~~упороться желудями~~ пощупать [Осень](https://github.com/autumn-library/autumn), [OneScript](https://github.com/EvilBeaver/OneScript), [библиотеки](https://github.com/oscript-library) и вот это вот всё.

Поделка позволяет взять специально подготовленный [шаблон](templates/template1.docx) и заполнить его на основании [конфигурационного файла](config/example.json). Производится распаковка контейнера Office Open XML во временный каталог, разбирается файл document.xml, производится замена параметров в соответствии в прописанным в конфигурационном файле, затем собирается обратно и кладётся в выходной каталог.

#### Варианты использования

###### 1. Запуск с помощью исходного кода
Клонируйте исходные коды на локальный компьютер.
Наполните файл настроек подстановки (config/example.json). Либо переопределите его и другие параметры в настройках приложения (autumn-properties.json).
Запустите приложение в настроенном окружении:
```code
oscript src/main.os
```

###### 2. Использование в качестве библиотеки

Скачать файл *.ospx из раздела releases
Воспользоваться командой:
```code
opm install -f <ПутьКФайлу>
```
Создать файл oscript следующего содержания:
```code
#Использовать autumn
#Использовать officer

Поделка = Новый Поделка();
Поделка.ЗапуститьПриложение();

Настройки = Поделка.НайтиЖелудь("НастройкиOfficer");
Настройки.УстановитьНастройку("КаталогШаблонов", "templates/");
Настройки.УстановитьНастройку("КаталогСохранения", "output/");
Настройки.УстановитьНастройку("КаталогВременныхФайлов", "temp/");
Настройки.УстановитьНастройку("ПутьКФайлуНастройкиПодстановки", "config/example.json");

Приложение = Поделка.НайтиЖелудь("ПриложениеOfficer");
Приложение.Запустить();
```
Проверить, что указанные в настройках каталоги существуют.
